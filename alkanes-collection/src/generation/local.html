<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Bulk NFT 10k Generator (Color Quota)</title>

    <style>
      body {
        font-family: monospace;
        padding: 2rem;
        background: #18181b;
        color: #fff;
      }
      button {
        margin: 1rem 0;
        padding: 0.5rem 1rem;
        border-radius: 6px;
        background: #262626;
        color: #fff;
        border: none;
        cursor: pointer;
      }
      #itemsOutput {
        background: #222;
        max-height: 400px;
        overflow: auto;
        padding: 16px;
        border-radius: 8px;
      }
      #analytics {
        background: #222;
        border-radius: 12px;
        padding: 16px;
        margin: 2rem 0;
        color: #fff;
        font-size: 14px;
        line-height: 1.6;
      }
      #analytics table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
      }
      #analytics th,
      #analytics td {
        padding: 4px 8px;
        border-bottom: 1px solid #333;
        text-align: left;
      }
      #analytics th {
        color: #eee;
      }
      #analytics td {
        color: #ccc;
      }
    </style>
  </head>
  <body>
    <h2>Generate 10,000 NFT Items by Color Quota</h2>

    <button id="generateItems">Generate 10,000 Items & Export JSON</button>
    <pre id="itemsOutput"></pre>
    <div id="analytics"></div>
    <script type="module">
      const traitFiles = {
        Hand: {
          green: [
            "Racket",
            "Coffe Mug",
            "Green Lightsaber",
            "Walkie-talkie",
            "Beer Mug",
            "Rail Gun",
            "Elder Staff",
            "Burger & Fork",
            "Magic Wand",
          ],
          gray: [
            "Racket",
            "Flash Drive",
            "Coffe Mug",
            "Butcher Knife",
            "Alien Gun",
            "Green Lightsaber",
            "Walkie-talkie",
            "Alien Sword",
            "Beer Mug",
            "Rail Gun",
            "Elder Staff",
            "Red Lightsaber",
            "Burger & Fork",
            "Magic Wand",
          ],
          golden: ["Golden Rail Gun", "Golden Lightsaber"],
          red: [
            "Coffe Mug",
            "Walkie-talkie",
            "Alien Sword",
            "Elder Staff",
            "Red Lightsaber",
            "Magic Wand",
          ],
          blue: [],
        },
        Hat: [
          "Egg Basket",
          "Trainer Cap",
          "Baseball Cap",
          "Propeller Hat",
          "Golden Halo",
          "Signal Antenna",
          "Golden Egg Basket",
          "Beanie",
          "Bird Hat",
          "Gentleman Hat",
          "Cooking Hat",
          "Adventurer Hat",
          "Farmer Hat",
          "Mushroom Hat",
          "Magic Hat",
          "Mining Hat",
          "Radio Antenna",
          "Plumber Hat",
          "Magician Hat",
          "Royal Crown",
          "Pirate Hat",
          "Angel Halo",
          "Cowboy Hat",
          "Mice Hat",
          "Imperial Crown",
        ],
        Back: [
          "Fairy Wings",
          "Backpack",
          "Imp Wings",
          "Drone 01",
          "Drone 03",
          "Drone 02",
          "Jetpack",
          "Golden Wings",
          "Golden Jetpack",
          "Angel Wings",
        ],
        Body: {
          green: [
            "Butcher Apron",
            "Mainframe 03",
            "Mainframe 02",
            "Mainframe 01",
            "Mainframe 05",
            "Mainframe 10",
            "Mainframe 09",
            "Mainframe 08",
            "Plumber Overalls",
          ],
          gray: [
            "Hooded Sweatshirt",
            "Lab Coat",
            "Suit",
            "Leather Jacket",
            "Skull Shirt",
            "Butcher Apron",
            "Mainframe 03",
            "Mainframe 02",
            "Mainframe 01",
            "Mainframe 05",
            "Mainframe 10",
            "Mainframe 04",
            "Mainframe 06",
            "Mainframe 07",
            "Mainframe 09",
            "Mainframe 08",
            "Plumber Overalls",
            "Striped Shirt",
            "Blazer",
          ],
          blue: [
            "Mainframe 03",
            "Mainframe 02",
            "Mainframe 01",
            "Mainframe 05",
            "Mainframe 10",
            "Mainframe 04",
            "Mainframe 06",
            "Mainframe 07",
            "Mainframe 09",
            "Mainframe 08",
          ],
          golden: ["Golden Frame", "Golden Chassis", "Golden Hull"],
          red: [
            "Lab Coat",
            "Skull Shirt",
            "Butcher Apron",
            "Mainframe 05",
            "Mainframe 10",
            "Mainframe 04",
            "Mainframe 06",
            "Mainframe 09",
            "Mainframe 08",
            "Plumber Overalls",
          ],
        },
        Head: {
          green: [
            "Party Glasses",
            "Processing Unit 09",
            "Processing Unit 07",
            "Processing Unit 13",
            "Processing Unit 12",
            "Processing Unit 06",
            "Processing Unit 10",
            "Sunglasses",
            "Seed Unit",
            "Brain Unit",
            "Energy Unit",
            "Organic Unit",
          ],
          gray: [
            "Brain Unit",
            "Organic Unit",
            "Party Glasses",
            "Processing Unit 08",
            "Processing Unit 09",
            "Seed Unit",
            "Processing Unit 01",
            "Processing Unit 14",
            "Processing Unit 02",
            "Processing Unit 03",
            "Processing Unit 07",
            "Processing Unit 13",
            "Processing Unit 12",
            "Processing Unit 06",
            "Processing Unit 10",
            "Processing Unit 04",
            "Processing Unit 05",
            "Processing Unit 11",
            "Sunglasses",
            "Energy Unit",
          ],
          blue: [
            "Party Glasses",
            "Processing Unit 01",
            "Processing Unit 03",
            "Processing Unit 13",
            "Processing Unit 12",
            "Processing Unit 06",
            "Processing Unit 10",
            "Processing Unit 04",
            "Processing Unit 05",
            "Sunglasses",
            "Seed Unit",
            "Brain Unit",
            "Energy Unit",
            "Organic Unit",
          ],
          golden: [
            "Golden Neuron",
            "Golden Cortex",
            "Golden Analyzer",
            "Golden Synapse",
          ],
          red: [
            "Party Glasses",
            "Processing Unit 08",
            "Processing Unit 09",
            "Processing Unit 14",
            "Processing Unit 07",
            "Processing Unit 13",
            "Processing Unit 12",
            "Processing Unit 06",
            "Processing Unit 10",
            "Processing Unit 04",
            "Processing Unit 11",
            "Sunglasses",
            "Seed Unit",
            "Brain Unit",
            "Energy Unit",
            "Organic Unit",
          ],
        },
      }
      const colorList = ["gray", "red", "blue", "green", "golden"]
      function pick(arr) {
        return arr[Math.floor(Math.random() * arr.length)]
      }
      function maybeOptional(arr) {
        return arr.length && Math.random() < 0.5 ? pick(arr) : null
      }
      function getTraitsForRarity(rarity, idx) {
        if (rarity === "golden") {
          let traits = {
            rarity: "golden",
            Back: pick(traitFiles.Back),
            Body: pick(traitFiles.Body.golden),
            Head: pick(traitFiles.Head.golden),
            BodyColor: "golden",
            HeadColor: "golden",
            Hand: null,
            HandColor: null,
            Hat: null,
          }
          if (idx === 0 || idx === 1) {
            traits.Hand = traitFiles.Hand.golden[idx]
            traits.HandColor = "golden"
          }
          if (idx >= 2 && idx < 27) {
            traits.Hat = traitFiles.Hat[idx - 2]
          }
          return traits
        }
        if (rarity === "blue") {
          return {
            rarity: "blue",
            Back: pick(traitFiles.Back),
            Body: pick(traitFiles.Body.blue),
            BodyColor: "blue",
            Head: pick(traitFiles.Head.blue),
            HeadColor: "blue",
            Hand: null,
            HandColor: null,
            Hat: null,
          }
        }
        if (["gray", "red", "green"].includes(rarity)) {
          return {
            rarity,
            Back: pick(traitFiles.Back),
            Body: pick(traitFiles.Body[rarity]),
            BodyColor: rarity,
            Head: pick(traitFiles.Head[rarity]),
            HeadColor: rarity,
            Hand: maybeOptional(traitFiles.Hand[rarity]),
            HandColor: rarity,
            Hat: maybeOptional(traitFiles.Hat),
          }
        }
        if (rarity === "mixed") {
          let bColor = pick(colorList),
            hColor = pick(colorList)
          return {
            rarity: "mixed",
            Back: pick(traitFiles.Back),
            Body: pick(traitFiles.Body[bColor]),
            BodyColor: bColor,
            Head: pick(traitFiles.Head[hColor]),
            HeadColor: hColor,
            Hand: maybeOptional(traitFiles.Hand[bColor]),
            HandColor: bColor,
            Hat: maybeOptional(traitFiles.Hat),
          }
        }
        if (rarity === "oneof") {
          let c = pick(colorList)
          return {
            rarity: "oneof",
            Back: pick(traitFiles.Back),
            Body: pick(traitFiles.Body[c]),
            BodyColor: c,
            Head: pick(traitFiles.Head[c]),
            HeadColor: c,
            Hand: maybeOptional(traitFiles.Hand[c]),
            HandColor: c,
            Hat: maybeOptional(traitFiles.Hat),
          }
        }
        return {
          rarity: "gray",
          Back: pick(traitFiles.Back),
          Body: pick(traitFiles.Body.gray),
          BodyColor: "gray",
          Head: pick(traitFiles.Head.gray),
          HeadColor: "gray",
          Hand: maybeOptional(traitFiles.Hand.gray),
          HandColor: "gray",
          Hat: maybeOptional(traitFiles.Hat),
        }
      }
      function encodeTraits(traits) {
        // You can implement encoding if you want. Example:
        return traits
      }
      function getFullTraitsListFor10k() {
        let rarities = [
          ...Array(6000).fill("gray"),
          ...Array(1000).fill("red"),
          ...Array(1000).fill("blue"),
          ...Array(1000).fill("green"),
          ...Array(216).fill("golden"),
          ...Array(744).fill("mixed"),
          ...Array(40).fill("oneof"),
        ]
        rarities = rarities.sort(() => Math.random() - 0.5)
        const result = []
        for (let i = 0; i < 10000; i++) {
          result.push(getTraitsForRarity(rarities[i], i))
        }
        return result
      }
      function getAnalytics(traitsList) {
        const rarityCount = {},
          colorCount = {},
          traitCounts = {}
        for (const t of traitsList) {
          rarityCount[t.rarity] = (rarityCount[t.rarity] || 0) + 1
          colorCount[t.BodyColor] = (colorCount[t.BodyColor] || 0) + 1
          for (const k of ["Back", "Body", "Head", "Hand", "Hat"]) {
            if (!traitCounts[k]) traitCounts[k] = {}
            if (t[k]) traitCounts[k][t[k]] = (traitCounts[k][t[k]] || 0) + 1
          }
        }
        return { rarityCount, colorCount, traitCounts }
      }
      function renderAnalytics(analytics) {
        const { rarityCount, colorCount, traitCounts } = analytics
        let html = `<h3>Analytics of 10,000 NFTs</h3>`
        html +=
          "<strong>Rarity Distribution:</strong><br/><table><tr><th>Rarity</th><th>Count</th></tr>"
        for (const [rarity, count] of Object.entries(rarityCount)) {
          html += `<tr><td>${rarity}</td><td>${count}</td></tr>`
        }
        html += "</table>"
        html +=
          "<br/><strong>BodyColor Distribution:</strong><br/><table><tr><th>Color</th><th>Count</th></tr>"
        for (const [color, count] of Object.entries(colorCount)) {
          html += `<tr><td>${color}</td><td>${count}</td></tr>`
        }
        html += "</table>"
        html += "<br/><strong>Trait Counts (first 12 of each):</strong><br/>"
        for (const [trait, obj] of Object.entries(traitCounts)) {
          html += `<details><summary>${trait}</summary><table><tr><th>Value</th><th>Count</th></tr>`
          Object.entries(obj)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 12)
            .forEach(([val, count]) => {
              html += `<tr><td>${val}</td><td>${count}</td></tr>`
            })
          html += "</table></details>"
        }
        return html
      }
      document.getElementById("generateItems").onclick = () => {
        const traitsList = getFullTraitsListFor10k()
        const items = traitsList.map(encodeTraits)
        document.getElementById("itemsOutput").textContent = JSON.stringify(
          items,
          null,
          2
        )
        const blob = new Blob([JSON.stringify(items)], {
          type: "application/json",
        })
        const url = URL.createObjectURL(blob)
        const a = document.createElement("a")
        a.href = url
        a.download = "items-10k.json"
        a.innerText = "Download items-10k.json"
        document
          .getElementById("itemsOutput")
          .appendChild(document.createElement("br"))
        document.getElementById("itemsOutput").appendChild(a)
        // Analytics
        const analytics = getAnalytics(traitsList)
        document.getElementById("analytics").innerHTML =
          renderAnalytics(analytics)
      }

      const LAYER_ORDER = [
        { key: "Back", folder: "Back" },
        { key: "Body", folder: "Body" },
        { key: "Head", folder: "Head" },
        { key: "Hat", folder: "Hat" },
        { key: "Hand", folder: "Hand" },
      ]

      function traitPath(traits, layer) {
        if (!traits[layer.key]) return null
        return `./traits/${layer.folder}/${traits[layer.key]}.png`
      }

      function loadImageSafe(path) {
        return new Promise((resolve) => {
          const img = new window.Image()
          img.onload = () => resolve(img)
          img.onerror = () => resolve(null)
          img.src = path
        })
      }

      async function renderNFT(traits) {
        const canvas = document.createElement("canvas")
        canvas.width = 120
        canvas.height = 120
        const ctx = canvas.getContext("2d")
        ctx.clearRect(0, 0, 120, 120)
        ctx.fillStyle = "#18181b"
        ctx.fillRect(0, 0, 120, 120)
        for (const layer of LAYER_ORDER) {
          const path = traitPath(traits, layer)
          if (path) {
            const img = await loadImageSafe(path)
            if (img) ctx.drawImage(img, 0, 0, 120, 120)
          }
        }
        return canvas
      }

      function previewMany(traitsList) {
        let area = document.getElementById("previewArea")
        if (!area) {
          area = document.createElement("div")
          area.id = "previewArea"
          document.body.appendChild(area)
        }
        area.innerHTML = ""
        ;(async () => {
          for (let i = 0; i < traitsList.length; ++i) {
            const wrap = document.createElement("div")
            wrap.className = "nft-preview"
            const canvas = await renderNFT(traitsList[i])
            wrap.appendChild(canvas)
            wrap.innerHTML += `<span>#${i + 1}</span>`
            area.appendChild(wrap)
          }
        })()
      }

      const previewBtn = document.createElement("button")
      previewBtn.id = "preview20"
      previewBtn.innerText = "Preview 20 NFTs"
      document.body.insertBefore(previewBtn, document.body.children[1])

      document.getElementById("preview20").onclick = () => {
        const traitsList = []
        for (let i = 0; i < 20; ++i)
          traitsList.push(getTraitsForRarity("gray", i))
        previewMany(traitsList)
      }
    </script>
  </body>
</html>
