<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Generate 10K NFT Items JSON</title>
    <style>
      body {
        font-family: monospace;
        padding: 2rem;
        background: #18181b;
        color: #fff;
      }
      textarea,
      pre {
        width: 100%;
        height: 320px;
        background: #222;
        color: #fff;
        border-radius: 8px;
        padding: 8px;
      }
      button {
        margin: 1rem 0;
        padding: 0.5rem 1rem;
        border-radius: 6px;
        background: #262626;
        color: #fff;
        border: none;
        cursor: pointer;
      }
      label {
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h2>Generate 10K Encoded NFT Items</h2>
    <label
      >Paste your JSON (without "items" or with empty "items" array):</label
    >
    <textarea id="input" spellcheck="false"></textarea>
    <button id="generate">Generate 10,000 items</button>
    <label>Output JSON (with items):</label>
    <pre id="output"></pre>
    <script type="module">
      function getRandomInt(max) {
        return Math.floor(Math.random() * max)
      }

      // returns the encoded value for one NFT
      function encodeTraits(format, choices) {
        let value = 0
        for (const trait in format) {
          const { shift } = format[trait]
          value |= choices[trait] << shift
        }
        return value
      }

      document.getElementById("generate").onclick = () => {
        let json
        try {
          json = JSON.parse(document.getElementById("input").value)
        } catch (e) {
          alert("Invalid JSON.")
          return
        }
        const { format, indices } = json
        if (!format || !indices) {
          alert("JSON must have format and indices.")
          return
        }

        const traitNames = Object.keys(format)
        const items = []
        for (let i = 0; i < 10000; i++) {
          const choices = {}
          for (const trait of traitNames) {
            // For "Back", always choose random; for others, can also randomize or set patterns.
            if (trait === "Back") {
              choices[trait] = getRandomInt(indices[trait].length)
            } else {
              choices[trait] = getRandomInt(indices[trait].length)
            }
          }
          const encoded = encodeTraits(format, choices)
          items.push(encoded)
        }
        json.items = items
        document.getElementById("output").textContent = JSON.stringify(
          json,
          null,
          2
        )
      }
    </script>
  </body>
</html>
